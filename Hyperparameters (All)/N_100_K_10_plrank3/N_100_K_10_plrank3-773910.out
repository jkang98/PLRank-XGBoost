[I 2023-11-24 08:09:15,619] A new study created in memory with name: no-name-4bba1eeb-2d69-45bc-b84f-d08d8511626b
[I 2023-11-24 08:44:17,433] Trial 0 finished with value: 0.6001564658884885 and parameters: {'learning_rate': 1.251976251308437e-08, 'max_depth': 7, 'min_child_weight': 5, 'gamma': 0.07755456186937154, 'lambda': 0.001411805807380185, 'alpha': 2.5696934250363435e-05}. Best is trial 0 with value: 0.6001564658884885.
[I 2023-11-24 10:20:51,501] Trial 1 finished with value: 0.7339967267319089 and parameters: {'learning_rate': 0.016915127208004564, 'max_depth': 1, 'min_child_weight': 5, 'gamma': 2.8129431074915243e-05, 'lambda': 0.0001594382646709341, 'alpha': 5.4017004764971404e-08}. Best is trial 1 with value: 0.7339967267319089.
[I 2023-11-24 11:58:42,156] Trial 2 finished with value: 0.7303105143458214 and parameters: {'learning_rate': 0.00025256903236968036, 'max_depth': 5, 'min_child_weight': 6, 'gamma': 2.541366044159078e-07, 'lambda': 0.00439271003286562, 'alpha': 0.00010895883827088887}. Best is trial 1 with value: 0.7339967267319089.
[I 2023-11-24 13:36:34,931] Trial 3 finished with value: 0.7369873481836893 and parameters: {'learning_rate': 0.000765096343849624, 'max_depth': 5, 'min_child_weight': 5, 'gamma': 0.005480298096333492, 'lambda': 5.274173241866527e-07, 'alpha': 0.4354119304314125}. Best is trial 3 with value: 0.7369873481836893.
[I 2023-11-24 13:58:43,626] Trial 4 finished with value: 0.5961915359043417 and parameters: {'learning_rate': 4.029231765286989e-05, 'max_depth': 4, 'min_child_weight': 4, 'gamma': 9.875002603912556e-08, 'lambda': 0.0010553997519093228, 'alpha': 0.5622331233579854}. Best is trial 3 with value: 0.7369873481836893.
[I 2023-11-24 14:00:12,194] Trial 5 pruned. Trial was pruned at iteration 2.
[I 2023-11-24 14:01:40,830] Trial 6 pruned. Trial was pruned at iteration 2.
[I 2023-11-24 14:06:06,355] Trial 7 pruned. Trial was pruned at iteration 8.
[I 2023-11-24 15:22:41,548] Trial 8 finished with value: 0.7637162696272276 and parameters: {'learning_rate': 0.059453728339776926, 'max_depth': 7, 'min_child_weight': 8, 'gamma': 7.688746877152798e-07, 'lambda': 1.854242461697515e-08, 'alpha': 6.735801898628558e-05}. Best is trial 8 with value: 0.7637162696272276.
[I 2023-11-24 15:23:40,605] Trial 9 pruned. Trial was pruned at iteration 1.
[I 2023-11-24 15:24:39,597] Trial 10 pruned. Trial was pruned at iteration 1.
[I 2023-11-24 15:25:38,638] Trial 11 pruned. Trial was pruned at iteration 1.
[I 2023-11-24 15:27:07,046] Trial 12 pruned. Trial was pruned at iteration 2.
[I 2023-11-24 17:01:43,501] Trial 13 finished with value: 0.7557924998539278 and parameters: {'learning_rate': 0.011682200768906413, 'max_depth': 6, 'min_child_weight': 3, 'gamma': 0.0002960328452308756, 'lambda': 4.4733466120690494e-07, 'alpha': 0.024813777249397487}. Best is trial 8 with value: 0.7637162696272276.
/home/jkang1/plrank3.py:106: RuntimeWarning: divide by zero encountered in divide
  cumsum_weight_denom = np.cumsum(rank_weights[:cutoff] / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:108: RuntimeWarning: invalid value encountered in divide
  cumsum_reward_denom = np.cumsum(cumsum_labels / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:122: RuntimeWarning: invalid value encountered in multiply
  labels[cutoff_sampled_rankings]
/home/jkang1/plrank3.py:171: RuntimeWarning: divide by zero encountered in divide
  cumsum_denom = np.cumsum(1 / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:172: RuntimeWarning: invalid value encountered in multiply
  sum_prob_per_doc = exp_scores * cumsum_denom[:, -1, None]
/home/jkang1/plrank3.py:174: RuntimeWarning: invalid value encountered in multiply
  exp_scores[cutoff_sampled_rankings] * cumsum_denom
/home/jkang1/plrank3.py:182: RuntimeWarning: divide by zero encountered in divide
  cumsum_weight_denom = np.cumsum(rank_weights[:cutoff] / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:184: RuntimeWarning: invalid value encountered in divide
  cumsum_reward_denom = np.cumsum(cumsum_labels / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:197: RuntimeWarning: invalid value encountered in multiply
  labels[cutoff_sampled_rankings]
/home/jkang1/plrank3.py:208: RuntimeWarning: divide by zero encountered in divide
  rank_weights[:cutoff] / denom_per_rank ** 2, axis=1
/home/jkang1/plrank3.py:211: RuntimeWarning: invalid value encountered in divide
  cumsum_reward_denom_square = np.cumsum(cumsum_labels / denom_per_rank ** 2, axis=1)
/home/jkang1/plrank3.py:224: RuntimeWarning: invalid value encountered in multiply
  labels[cutoff_sampled_rankings]
/home/jkang1/plrank3.py:108: RuntimeWarning: divide by zero encountered in divide
  cumsum_reward_denom = np.cumsum(cumsum_labels / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:112: RuntimeWarning: invalid value encountered in multiply
  second_part = -exp_scores[None, :] * cumsum_reward_denom[:, -1, None]
/home/jkang1/plrank3.py:114: RuntimeWarning: invalid value encountered in multiply
  labels[relevant_docs][None, :]
/home/jkang1/plrank3.py:113: RuntimeWarning: invalid value encountered in add
  second_part[:, relevant_docs] += (
/home/jkang1/plrank3.py:126: RuntimeWarning: invalid value encountered in multiply
  sampled_following_reward = exp_scores[cutoff_sampled_rankings] * cumsum_reward_denom
/home/jkang1/plrank3.py:184: RuntimeWarning: divide by zero encountered in divide
  cumsum_reward_denom = np.cumsum(cumsum_labels / denom_per_rank, axis=1)
/home/jkang1/plrank3.py:187: RuntimeWarning: invalid value encountered in multiply
  second_part = -exp_scores[None, :] * cumsum_reward_denom[:, -1, None]
/home/jkang1/plrank3.py:189: RuntimeWarning: invalid value encountered in multiply
  labels[relevant_docs][None, :]
/home/jkang1/plrank3.py:188: RuntimeWarning: invalid value encountered in add
  second_part[:, relevant_docs] += (
/home/jkang1/plrank3.py:201: RuntimeWarning: invalid value encountered in multiply
  sampled_following_reward = exp_scores[cutoff_sampled_rankings] * cumsum_reward_denom
/home/jkang1/plrank3.py:211: RuntimeWarning: divide by zero encountered in divide
  cumsum_reward_denom_square = np.cumsum(cumsum_labels / denom_per_rank ** 2, axis=1)
/home/jkang1/plrank3.py:214: RuntimeWarning: invalid value encountered in multiply
  third_part = -exp_scores[None, :] ** 2 * cumsum_reward_denom_square[:, -1, None]
/home/jkang1/plrank3.py:216: RuntimeWarning: invalid value encountered in multiply
  labels[relevant_docs][None, :]
/home/jkang1/plrank3.py:215: RuntimeWarning: invalid value encountered in add
  third_part[:, relevant_docs] += (
/home/jkang1/plrank3.py:229: RuntimeWarning: invalid value encountered in multiply
  exp_scores[cutoff_sampled_rankings] ** 2 * cumsum_reward_denom_square
/home/jkang1/plrank3.py:166: RuntimeWarning: divide by zero encountered in divide
  * np.cumsum(1 / denom_per_rank[:, :-1], axis=1)
/home/jkang1/plrank3.py:165: RuntimeWarning: invalid value encountered in multiply
  - exp_scores[cutoff_sampled_rankings[:, :-1]]
[I 2023-11-24 18:34:08,591] Trial 14 finished with value: 0.7557157809857142 and parameters: {'learning_rate': 0.03554259523148087, 'max_depth': 7, 'min_child_weight': 2, 'gamma': 4.2454963988498935e-06, 'lambda': 6.627671847048811e-06, 'alpha': 0.0004545591823637939}. Best is trial 8 with value: 0.7637162696272276.
[I 2023-11-24 18:34:37,255] Trial 15 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:35:05,875] Trial 16 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:35:34,544] Trial 17 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:36:03,137] Trial 18 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:36:31,755] Trial 19 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:37:00,289] Trial 20 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:37:28,860] Trial 21 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:37:57,413] Trial 22 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:38:25,992] Trial 23 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:38:54,570] Trial 24 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:39:23,130] Trial 25 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:39:51,701] Trial 26 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:40:20,370] Trial 27 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:40:48,951] Trial 28 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:41:17,530] Trial 29 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:41:46,072] Trial 30 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:42:14,631] Trial 31 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:42:43,160] Trial 32 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:43:11,748] Trial 33 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:43:40,336] Trial 34 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:44:08,929] Trial 35 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:44:37,589] Trial 36 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:46:03,062] Trial 37 pruned. Trial was pruned at iteration 2.
[I 2023-11-24 18:46:31,581] Trial 38 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:47:00,103] Trial 39 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:47:28,603] Trial 40 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:47:57,127] Trial 41 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:48:25,640] Trial 42 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:48:54,173] Trial 43 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:49:22,639] Trial 44 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:49:51,113] Trial 45 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:50:19,538] Trial 46 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:50:47,964] Trial 47 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:51:16,432] Trial 48 pruned. Trial was pruned at iteration 0.
[I 2023-11-24 18:51:44,962] Trial 49 pruned. Trial was pruned at iteration 0.
Completed hyperparameter tuning with best ndcg@10 = 0.7637162696272276.
Re-running the best trial... params = {'verbosity': 0, 'eval_metric': 'ndcg@10', 'device': 'cuda', 'learning_rate': 0.059453728339776926, 'max_depth': 7, 'min_child_weight': 8, 'gamma': 7.688746877152798e-07, 'lambda': 1.854242461697515e-08, 'alpha': 6.735801898628558e-05}
